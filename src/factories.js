/// <reference path="../../.tmp/typings/angularjs/angular.d.ts" />
/// <reference path="../../.tmp/typings/requirejs/require.d.ts" />
var Factory = require('rosie').Factory;
var faker = require('faker');
var smartFactory;
(function (smartFactory) {
    function config(factoryName) {
        return function (target) {
            target.__rosieFactoryName__ = factoryName;
            target.factory = {
                list: function (size, overrideObj) {
                    return Factory.buildList(target.__rosieFactoryName__, size, overrideObj);
                },
                build: function (overrideObj) {
                    return Factory.build(target.__rosieFactoryName__, overrideObj);
                }
            };
        };
    }
    smartFactory.config = config;
    var FakerWrapper = (function () {
        function FakerWrapper() {
        }
        FakerWrapper.findName = function () {
            return this.faker.name.findName();
        };
        FakerWrapper.faker = faker;
        return FakerWrapper;
    })();
    smartFactory.FakerWrapper = FakerWrapper;
    var FactoryWrapper = (function () {
        function FactoryWrapper() {
        }
        FactoryWrapper.define = function (name, constructor) {
            var fac = new FactoryWrapper();
            fac.wrappedFactory = this.factory.define(name, constructor);
            return fac;
        };
        FactoryWrapper.build = function (name, attributes, options) {
            return this.factory.build(name, attributes, options);
        };
        FactoryWrapper.buildList = function (name, size, attributes, options) {
            return this.factory.build(name, size, attributes, options);
        };
        FactoryWrapper.attributes = function (attributes, options) {
            return this.factory.attributes(attributes, options);
        };
        FactoryWrapper.options = function (options) {
            return this.factory.options(options);
        };
        FactoryWrapper.extend = function (name) {
            return this.factory.extend(name);
        };
        FactoryWrapper.for = function (target) {
            if ((target.__rosieFactoryName__) && (target.factory)) {
                return target.factory;
            }
            else {
                throw new Error('no factory registered for ' + target.toString() + ' please check!');
            }
        };
        FactoryWrapper.prototype.attr = function (name, dependenciesOrValue, value) {
            if (dependenciesOrValue && dependenciesOrValue.constructor === Array) {
                this.wrappedFactory = this.wrappedFactory.attr(name, dependenciesOrValue, value);
            }
            else {
                this.wrappedFactory = this.wrappedFactory.attr(name, [], dependenciesOrValue);
            }
            return this;
        };
        FactoryWrapper.prototype.sequence = function (name, dependencies, builder) {
            if (dependencies === undefined && builder === undefined) {
                this.wrappedFactory = this.wrappedFactory.sequence(name);
            }
            else if (dependencies === undefined) {
                this.wrappedFactory = this.wrappedFactory.sequence(name, [], builder || null);
            }
            else {
                this.wrappedFactory = this.wrappedFactory.sequence(name, dependencies, builder || null);
            }
            return this;
        };
        FactoryWrapper.factory = Factory;
        return FactoryWrapper;
    })();
    smartFactory.FactoryWrapper = FactoryWrapper;
    var Service = (function () {
        function Service() {
            return FactoryWrapper;
        }
        return Service;
    })();
    smartFactory.Service = Service;
})(smartFactory || (smartFactory = {}));
if ((typeof (angular) != 'undefined')) {
    angular.module('smartFactory', []).service('Factory', smartFactory.Service);
}
else {
    if (console && console.error) {
        if (typeof (angular) == 'undefined') {
            console.error('smartFactory not registered beacuse angular is missing');
        }
        if (typeof (faker) == 'undefined') {
            console.error('smartFactory not registered beacuse faker.js is missing');
        }
        if (typeof (Factory) == 'undefined') {
            console.error('smartFactory not registered beacuse angular rosie is missing');
        }
    }
}
module.exports = smartFactory;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZhY3Rvcmllcy50cyJdLCJuYW1lcyI6WyJzbWFydEZhY3RvcnkiLCJzbWFydEZhY3RvcnkuY29uZmlnIiwic21hcnRGYWN0b3J5LkZha2VyV3JhcHBlciIsInNtYXJ0RmFjdG9yeS5GYWtlcldyYXBwZXIuY29uc3RydWN0b3IiLCJzbWFydEZhY3RvcnkuRmFrZXJXcmFwcGVyLmZpbmROYW1lIiwic21hcnRGYWN0b3J5LkZhY3RvcnlXcmFwcGVyIiwic21hcnRGYWN0b3J5LkZhY3RvcnlXcmFwcGVyLmNvbnN0cnVjdG9yIiwic21hcnRGYWN0b3J5LkZhY3RvcnlXcmFwcGVyLmRlZmluZSIsInNtYXJ0RmFjdG9yeS5GYWN0b3J5V3JhcHBlci5idWlsZCIsInNtYXJ0RmFjdG9yeS5GYWN0b3J5V3JhcHBlci5idWlsZExpc3QiLCJzbWFydEZhY3RvcnkuRmFjdG9yeVdyYXBwZXIuYXR0cmlidXRlcyIsInNtYXJ0RmFjdG9yeS5GYWN0b3J5V3JhcHBlci5vcHRpb25zIiwic21hcnRGYWN0b3J5LkZhY3RvcnlXcmFwcGVyLmV4dGVuZCIsInNtYXJ0RmFjdG9yeS5GYWN0b3J5V3JhcHBlci5mb3IiLCJzbWFydEZhY3RvcnkuRmFjdG9yeVdyYXBwZXIuYXR0ciIsInNtYXJ0RmFjdG9yeS5GYWN0b3J5V3JhcHBlci5zZXF1ZW5jZSIsInNtYXJ0RmFjdG9yeS5TZXJ2aWNlIiwic21hcnRGYWN0b3J5LlNlcnZpY2UuY29uc3RydWN0b3IiXSwibWFwcGluZ3MiOiJBQUFBLGtFQUFrRTtBQUNsRSxrRUFBa0U7QUFFbEUsSUFBSSxPQUFPLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sQ0FBQztBQUN2QyxJQUFJLEtBQUssR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7QUFLN0IsSUFBTyxZQUFZLENBK0dsQjtBQS9HRCxXQUFPLFlBQVksRUFBQyxDQUFDO0lBRW5CQSxnQkFBdUJBLFdBQW1CQTtRQUN4Q0MsTUFBTUEsQ0FBQ0EsVUFBQ0EsTUFBV0E7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S0FBSyxDQUFDLENBQUEsQ0FBQztRQUMzQixFQUFFLENBQUEsQ0FBQyxPQUFNLENBQUMsT0FBTyxDQUFDLElBQUksV0FBVyxDQUFDLENBQUEsQ0FBQztZQUMvQixPQUFPLENBQUMsS0FBSyxDQUFDLHdEQUF3RCxDQUFDLENBQUM7UUFDNUUsQ0FBQztRQUNELEVBQUUsQ0FBQSxDQUFDLE9BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxXQUFXLENBQUMsQ0FBQSxDQUFDO1lBQzdCLE9BQU8sQ0FBQyxLQUFLLENBQUMseURBQXlELENBQUMsQ0FBQztRQUM3RSxDQUFDO1FBQ0QsRUFBRSxDQUFBLENBQUMsT0FBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLFdBQVcsQ0FBQyxDQUFBLENBQUM7WUFDL0IsT0FBTyxDQUFDLEtBQUssQ0FBQyw4REFBOEQsQ0FBQyxDQUFDO1FBQ2xGLENBQUM7SUFDSCxDQUFDO0FBQ0gsQ0FBQztBQUVELGlCQUFTLFlBQVksQ0FBQyIsImZpbGUiOiJmYWN0b3JpZXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vLnRtcC90eXBpbmdzL2FuZ3VsYXJqcy9hbmd1bGFyLmQudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uLy50bXAvdHlwaW5ncy9yZXF1aXJlanMvcmVxdWlyZS5kLnRzXCIgLz5cblxudmFyIEZhY3RvcnkgPSByZXF1aXJlKCdyb3NpZScpLkZhY3Rvcnk7XG52YXIgZmFrZXIgPSByZXF1aXJlKCdmYWtlcicpO1xuZGVjbGFyZSB2YXIgYW5ndWxhcjogbmcuSUFuZ3VsYXJTdGF0aWM7XG5cbi8vaW1wb3J0ICogYXMgc21hcnRGYWN0b3J5RGVjb3JhdG9yIGZyb20gJy4vY29uZmlnRGVjb3JhdG9yJztcblxubW9kdWxlIHNtYXJ0RmFjdG9yeSB7XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIGNvbmZpZyhmYWN0b3J5TmFtZTogc3RyaW5nKSB7XG4gICAgcmV0dXJuICh0YXJnZXQ6IGFueSkgPT4ge1xuICAgICAgKDxzbWFydEZhY3RvcnkuSUNvbnN0cnVjdG9yV2l0aEZhY3Rvcnk+dGFyZ2V0KS5fX3Jvc2llRmFjdG9yeU5hbWVfXyA9IGZhY3RvcnlOYW1lO1xuXG4gICAgICAoPHNtYXJ0RmFjdG9yeS5JQ29uc3RydWN0b3JXaXRoRmFjdG9yeT50YXJnZXQpLmZhY3RvcnkgPSB7XG4gICAgICAgIGxpc3Q6IGZ1bmN0aW9uKHNpemU6IG51bWJlciwgb3ZlcnJpZGVPYmo/OiBPYmplY3QpIHtcbiAgICAgICAgICByZXR1cm4gRmFjdG9yeS5idWlsZExpc3QodGFyZ2V0Ll9fcm9zaWVGYWN0b3J5TmFtZV9fLCBzaXplLCBvdmVycmlkZU9iaik7XG4gICAgICAgIH0sXG4gICAgICAgIGJ1aWxkOiBmdW5jdGlvbihvdmVycmlkZU9iaj86IE9iamVjdCkge1xuICAgICAgICAgIHJldHVybiBGYWN0b3J5LmJ1aWxkKHRhcmdldC5fX3Jvc2llRmFjdG9yeU5hbWVfXywgb3ZlcnJpZGVPYmopO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH07XG4gIH1cblxuICBleHBvcnQgaW50ZXJmYWNlIEZhY3RvcnlGYWNpbGl0aWVzIHtcbiAgICBsaXN0KHNpemU6IG51bWJlciwgb3ZlcnJpZGVPYmo/OiBPYmplY3QpO1xuICAgIGJ1aWxkKG92ZXJyaWRlT2JqPzogT2JqZWN0KTtcbiAgfVxuXG4gIGV4cG9ydCBpbnRlcmZhY2UgSUNvbnN0cnVjdG9yV2l0aEZhY3Rvcnkge1xuICAgIF9fcm9zaWVGYWN0b3J5TmFtZV9fOiBzdHJpbmc7XG4gICAgZmFjdG9yeTogYW55O1xuICB9XG5cbiAgZXhwb3J0IGNsYXNzIEZha2VyV3JhcHBlciB7XG4gICAgc3RhdGljIGZha2VyOiBhbnkgPSBmYWtlcjtcblxuXG5cbiAgICBwdWJsaWMgc3RhdGljIGZpbmROYW1lKCk6IHN0cmluZyB7XG4gICAgICByZXR1cm4gdGhpcy5mYWtlci5uYW1lLmZpbmROYW1lKCk7XG4gICAgfVxuICB9XG5cbiAgZXhwb3J0IGNsYXNzIEZhY3RvcnlXcmFwcGVyIHtcbiAgICBzdGF0aWMgZmFjdG9yeTogYW55ID0gRmFjdG9yeTtcblxuICAgIHdyYXBwZWRGYWN0b3J5OiBhbnk7XG4gICAgbmFtZTogc3RyaW5nO1xuXG5cbiAgICBwdWJsaWMgc3RhdGljIGRlZmluZShuYW1lOiBTdHJpbmcsIGNvbnN0cnVjdG9yPzogRnVuY3Rpb24pOiAgRmFjdG9yeVdyYXBwZXJ7XG4gICAgICB2YXIgZmFjOiBGYWN0b3J5V3JhcHBlciA9ICBuZXcgRmFjdG9yeVdyYXBwZXIoKTtcbiAgICAgIGZhYy53cmFwcGVkRmFjdG9yeSA9IDxGYWN0b3J5V3JhcHBlcj50aGlzLmZhY3RvcnkuZGVmaW5lKG5hbWUsIGNvbnN0cnVjdG9yKTtcbiAgICAgIHJldHVybiBmYWM7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBidWlsZChuYW1lOiBzdHJpbmcsIGF0dHJpYnV0ZXM/OiBhbnlbXSwgb3B0aW9ucz86IE9iamVjdCk6IE9iamVjdCB7XG4gICAgICByZXR1cm4gdGhpcy5mYWN0b3J5LmJ1aWxkKG5hbWUsIGF0dHJpYnV0ZXMsIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgYnVpbGRMaXN0KG5hbWU6IHN0cmluZywgc2l6ZTogbnVtYmVyLCBhdHRyaWJ1dGVzPzogYW55W10sIG9wdGlvbnM/OiBPYmplY3QpOiBPYmplY3RbXSB7XG4gICAgICByZXR1cm4gdGhpcy5mYWN0b3J5LmJ1aWxkKG5hbWUsIHNpemUsIGF0dHJpYnV0ZXMsIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgYXR0cmlidXRlcyhhdHRyaWJ1dGVzOiBPYmplY3QsIG9wdGlvbnM/OiBPYmplY3QpOiBPYmplY3Qge1xuICAgICAgcmV0dXJuIHRoaXMuZmFjdG9yeS5hdHRyaWJ1dGVzKGF0dHJpYnV0ZXMsIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgb3B0aW9ucyhvcHRpb25zOiBPYmplY3QpOiBPYmplY3Qge1xuICAgICAgcmV0dXJuIHRoaXMuZmFjdG9yeS5vcHRpb25zKG9wdGlvbnMpO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgZXh0ZW5kKG5hbWU6IHN0cmluZyl7XG4gICAgICByZXR1cm4gdGhpcy5mYWN0b3J5LmV4dGVuZChuYW1lKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIGZvcih0YXJnZXQ6IGFueSkgOiBGYWN0b3J5RmFjaWxpdGllcyB7XG4gICAgICBpZigoKDxhbnk+dGFyZ2V0KS5fX3Jvc2llRmFjdG9yeU5hbWVfXykgJiYgICgoPGFueT50YXJnZXQpLmZhY3RvcnkpKSB7XG4gICAgICAgIHJldHVybiAoPHNtYXJ0RmFjdG9yeS5JQ29uc3RydWN0b3JXaXRoRmFjdG9yeT4oPGFueT50YXJnZXQpKS5mYWN0b3J5O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdubyBmYWN0b3J5IHJlZ2lzdGVyZWQgZm9yICcgKyB0YXJnZXQudG9TdHJpbmcoKSArICcgcGxlYXNlIGNoZWNrIScpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGF0dHIobmFtZTogc3RyaW5nLCBkZXBlbmRlbmNpZXNPclZhbHVlOiBhbnkgfCBzdHJpbmdbXSwgdmFsdWU/OiBhbnkpOiBGYWN0b3J5V3JhcHBlciB7XG4gICAgICBpZihkZXBlbmRlbmNpZXNPclZhbHVlICYmIGRlcGVuZGVuY2llc09yVmFsdWUuY29uc3RydWN0b3IgPT09IEFycmF5KXtcbiAgICAgICAgdGhpcy53cmFwcGVkRmFjdG9yeSA9ICg8RmFjdG9yeVdyYXBwZXI+dGhpcy53cmFwcGVkRmFjdG9yeSkuYXR0cihuYW1lLCBkZXBlbmRlbmNpZXNPclZhbHVlLCB2YWx1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLndyYXBwZWRGYWN0b3J5ID0gKDxGYWN0b3J5V3JhcHBlcj50aGlzLndyYXBwZWRGYWN0b3J5KS5hdHRyKG5hbWUsIFtdLCBkZXBlbmRlbmNpZXNPclZhbHVlKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgc2VxdWVuY2UobmFtZTogc3RyaW5nLCBkZXBlbmRlbmNpZXM/OiBzdHJpbmdbXSwgYnVpbGRlcj86IEZ1bmN0aW9uKSA6IEZhY3RvcnlXcmFwcGVyIHtcbiAgICAgIGlmIChkZXBlbmRlbmNpZXMgPT09IHVuZGVmaW5lZCAmJiBidWlsZGVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhpcy53cmFwcGVkRmFjdG9yeSA9ICg8RmFjdG9yeVdyYXBwZXI+dGhpcy53cmFwcGVkRmFjdG9yeSkuc2VxdWVuY2UobmFtZSk7XG4gICAgICB9IGVsc2UgaWYoZGVwZW5kZW5jaWVzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhpcy53cmFwcGVkRmFjdG9yeSA9ICg8RmFjdG9yeVdyYXBwZXI+dGhpcy53cmFwcGVkRmFjdG9yeSkuc2VxdWVuY2UobmFtZSwgW10sIGJ1aWxkZXIgfHwgbnVsbCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLndyYXBwZWRGYWN0b3J5ID0gKDxGYWN0b3J5V3JhcHBlcj50aGlzLndyYXBwZWRGYWN0b3J5KS5zZXF1ZW5jZShuYW1lLCBkZXBlbmRlbmNpZXMsIGJ1aWxkZXIgfHwgbnVsbCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgfVxuXG4gIGV4cG9ydCBjbGFzcyBTZXJ2aWNlIHtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgcmV0dXJuIEZhY3RvcnlXcmFwcGVyO1xuICAgIH1cblxuXG5cbiAgfVxuXG59XG5cbmlmICgodHlwZW9mKGFuZ3VsYXIpICE9ICd1bmRlZmluZWQnKSkge1xuICBhbmd1bGFyLm1vZHVsZSgnc21hcnRGYWN0b3J5JywgW10pLnNlcnZpY2UoJ0ZhY3RvcnknLCBzbWFydEZhY3RvcnkuU2VydmljZSk7XG59IGVsc2Uge1xuICBpZihjb25zb2xlICYmIGNvbnNvbGUuZXJyb3Ipe1xuICAgIGlmKHR5cGVvZihhbmd1bGFyKSA9PSAndW5kZWZpbmVkJyl7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ3NtYXJ0RmFjdG9yeSBub3QgcmVnaXN0ZXJlZCBiZWFjdXNlIGFuZ3VsYXIgaXMgbWlzc2luZycpO1xuICAgIH1cbiAgICBpZih0eXBlb2YoZmFrZXIpID09ICd1bmRlZmluZWQnKXtcbiAgICAgICAgY29uc29sZS5lcnJvcignc21hcnRGYWN0b3J5IG5vdCByZWdpc3RlcmVkIGJlYWN1c2UgZmFrZXIuanMgaXMgbWlzc2luZycpO1xuICAgIH1cbiAgICBpZih0eXBlb2YoRmFjdG9yeSkgPT0gJ3VuZGVmaW5lZCcpe1xuICAgICAgICBjb25zb2xlLmVycm9yKCdzbWFydEZhY3Rvcnkgbm90IHJlZ2lzdGVyZWQgYmVhY3VzZSBhbmd1bGFyIHJvc2llIGlzIG1pc3NpbmcnKTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0ID0gc21hcnRGYWN0b3J5O1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9